MeshSize = [5,10,20,40,80,160,320,640,1280,2560,5120,10240,20480];
weakconvergence = [2.198916e-02, 2.161874e-02, 2.088228e-02, 1.943313e-02, 1.666919e-02, 1.190118e-02, 6.077960e-03, 2.324555e-03, 7.447785e-04, 2.121011e-04, 5.638954e-05, 1.449901e-05,3.672210e-06];
weakc2 = [2.199782e-02,2.163459e-02,2.090697e-02,1.946071e-02,1.667559e-02,1.188850e-02,6.077960e-03,2.324555e-03,7.447785e-04,2.121011e-04,5.638954e-05,1.449901e-05,3.672210e-06];
strongConvergence = [2.398669e-01,1.674838e-01, 1.154416e-01,7.746865e-02,4.909364e-02,2.737814e-02,1.155087e-02,3.514771e-03,9.344938e-04,2.368000e-04,5.940368e-05,1.486373e-05,3.716735e-06];
strong =            [2.455437e-01,1.716407e-01, 1.180798e-01, 7.894313e-02,4.968957e-02,2.753870e-02, 1.208174e-02, 3.553499e-03, 9.344938e-04,2.368000e-04,5.940368e-05,1.486373e-05,3.716735e-06];

weakUpwind = [2.206256e-02,2.176456e-02,2.385165e-02,2.000167e-02,1.776761e-02,1.392192e-02,6.082941e-03,4.112165e-03,1.116483e-03,2.459804e-04,5.638954e-05,1.449901e-05,3.672210e-06];
loglog(MeshSize,weakconvergence,'bo-');
hold on
loglog(MeshSize,weakc2,'bs-');
hold on
loglog(MeshSize,strongConvergence,'b*-');
hold on
%legend('weak convergence','strong+upwind Convergence')

for i = 1:length(MeshSize)-1
    ratioWeak(i) = weakconvergence(i)^0.5/weakconvergence(i+1)^0.5;
    ratioStrong(i) = strongConvergence(i)^0.5/strongConvergence(i+1)^0.5;
end

ratioWeak
%ratioStrong


weakCoth = [4.962425e-04, 4.917035e-04, 4.806417e-04, 4.526546e-04, 3.848321e-04, 2.501553e-04, 9.113144e-05, 1.546318e-05,1.465137e-06, 1.027640e-07, 6.449124e-09, 3.949815e-10, 2.425410e-11];
strongCoth = [6.517667e-02, 3.185333e-02, 1.520667e-02, 6.913333e-03, 2.826681e-03, 9.061375e-04, 1.776801e-04, 1.927621e-05, 1.449696e-06, 9.533588e-08, 6.036786e-09, 3.785406e-10, 2.367827e-11];
loglog(MeshSize,weakCoth.^0.5,'ko-');
hold on
loglog(MeshSize,strongCoth.^0.5,'k*-');
hold on
weakSqrt = [4.964340e-04, 4.924064e-04, 4.829989e-04, 4.591647e-04, 3.965009e-04, 2.587315e-04, 9.284811e-05, 1.556102e-05, 1.467560e-06, 1.028048e-07, 6.449736e-09, 3.949906e-10, 2.425424e-11];
strongSqrt = [6.549647e-02, 3.215928e-02, 1.548435e-02, 7.135005e-03, 2.953778e-03, 9.402211e-04, 1.806632e-04, 1.937604e-05, 1.451697e-06, 9.536935e-08, 6.037318e-09, 3.785490e-10, 2.367840e-11];

%loglog(MeshSize,weakSqrt,'yo-');
%hold on
%loglog(MeshSize,strongSqrt,'y*-');
%hold on

weakShapeFunc = [4.963433e-04, 4.920933e-04, 4.821034e-04, 4.578154e-04, 4.011425e-04, 2.913658e-04, 1.481040e-04, 4.476470e-05, 7.673228e-06, 8.380572e-07, 6.987936e-08, 5.063594e-09, 3.414206e-10];
strongShapeFunc = [6.534456e-02, 3.202239e-02, 1.537790e-02, 7.088234e-03, 3.006170e-03, 1.080375e-03, 2.923526e-04, 5.559183e-05, 7.594825e-06, 7.888099e-07, 6.670342e-08, 4.929153e-09, 3.366036e-10];
strong = [2.455437e-01,1.716407e-01, 1.180798e-01, 7.894313e-02,4.968957e-02,2.753870e-02, 1.208174e-02, 3.553499e-03, 9.344938e-04,2.368000e-04,5.940368e-05,1.486373e-05,3.716735e-06];

loglog(MeshSize,weakShapeFunc.^0.5,'ro-');
hold on
loglog(MeshSize,strongShapeFunc.^0.5,'r*-');
hold on
%loglog(MeshSize,strong,'y*-');
%hold on
legend('weak local VGI','weak c2=2 local VGI','strong+upwing local VGI','weak coth','strong coth','weak ShapeFunc','strong ShapeFunc')
xlabel('MeshSize')
ylabel('Estimate Error')

hold on
x = [5120,20480];
y = [4.0000e-05, 0.2500e-05];
loglog(x,y,'c');

hold on
x = [10,40];
y = [1.0000e-01, 0.500e-01];
loglog(x,y,'c');

% test = [3.827711e-03,1.243511e-02,3.018798e-02,5.001553e-02,6.203483e-02];
% h = [1/128,1/64,1/32,1/16,1/8];
% figure(4)
% loglog(h,test)
% 
% hold on
% x = [1/128,1/32];
% y = [0.5e-3, 0.008];
% xlim([1e-3,1e-1])
% loglog(x,y,'r');


% %[2.199782e-02,2.163459e-02,2.090697e-02,1.946071e-02,1.667559e-02,1.188850e-02,6.077960e-03,2.324555e-03,7.447785e-04,2.121011e-04,5.638954e-05,1.449901e-05,3.672210e-06];
% c22Iter = [192,173,102,63,37,19,1,1,1,1,1,1,1];
% c21Iter = [128,124,122,124,123,115,1,1,1,1,1,1,1];
% figure(4)
% loglog(MeshSize,c21Iter,'o-')
% hold on
% loglog(MeshSize,c22Iter,'o-')
% legend('c2=1 Iteration Number','c2=2 Iteration Number')
%[2.198916e-02, 2.161874e-02, 2.088228e-02, 1.943313e-02, 1.666919e-02, 1.190118e-02, 6.077960e-03, 2.324555e-03, 7.447785e-04, 2.121011e-04, 5.638954e-05, 1.449901e-05];